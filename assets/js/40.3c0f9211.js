(window.webpackJsonp=window.webpackJsonp||[]).push([[40],{491:function(s,t,a){s.exports=a.p+"assets/img/RequiredDuringExecution.8a79caba.png"},755:function(s,t,a){"use strict";a.r(t);var e=a(4),n=Object(e.a)({},(function(){var s=this,t=s.$createElement,e=s._self._c||t;return e("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[e("p",[e("code",[s._v("nodeSelector")]),s._v("的缺点：强制约束，Pod只能在固定的一批节点中进行调度，若找不到指定的标签，直接调度失败。")]),s._v(" "),e("p",[s._v("使用亲和性的优点：")]),s._v(" "),e("ul",[e("li",[s._v("表述语法更加多样化，不再仅受限于强制约束与匹配")]),s._v(" "),e("li",[s._v("调度规则不再是强制约束（hard），取而代之的是软限（soft）或偏好（preference）")]),s._v(" "),e("li",[s._v("指定pod可以和哪些pod部署在同一个/不同拓扑结构下")])]),s._v(" "),e("p",[e("code",[s._v("affinity")]),s._v("根据匹配的内容可以分为三种：")]),s._v(" "),e("ul",[e("li",[e("code",[s._v("nodeAffinity")]),s._v(" - Node亲和性：“这个Pod应该部署在这个Node上”")]),s._v(" "),e("li",[e("code",[s._v("podAffinity")]),s._v(" - Pod亲和性：“这个Pod应该和那个Pod部署在一起”")]),s._v(" "),e("li",[e("code",[s._v("podAntiAffinity")]),s._v(" - Pod反亲和性：“这个Pod不应该和那个Pod部署在一起”")])]),s._v(" "),e("h2",{attrs:{id:"亲和性调度策略"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#亲和性调度策略"}},[s._v("#")]),s._v(" 亲和性调度策略")]),s._v(" "),e("h3",{attrs:{id:"预备知识：k8s调度流程与硬-软策略"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#预备知识：k8s调度流程与硬-软策略"}},[s._v("#")]),s._v(" 预备知识：K8S调度流程与硬/软策略")]),s._v(" "),e("ol",[e("li",[s._v("预选(predicate)：遍历所有节点，选择出符合预选策略 (又称 "),e("strong",[s._v("“硬策略”")]),s._v(" ) 要求的候选节点。若没有符合要求的，那就一直重试直到有符合要求的节点出现。")]),s._v(" "),e("li",[s._v("优选(priority)：在选择出符合要求的候选节点中，根据优选策略 (又称 "),e("strong",[s._v("“软策略”")]),s._v(" ) 计算出每个节点的得分，最后选择得分最高的。")]),s._v(" "),e("li",[s._v("选定(select)：如果最高得分有好几个节点，select就会从中随机选择一个节点。")])]),s._v(" "),e("h3",{attrs:{id:"在调度期的pod调度策略和在运行过程中的pod调度策略"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#在调度期的pod调度策略和在运行过程中的pod调度策略"}},[s._v("#")]),s._v(" 在调度期的Pod调度策略和在运行过程中的Pod调度策略")]),s._v(" "),e("p",[s._v("在亲和性调度规则的定义文件中，除了指定一个调度规则是硬策略还是软策略外，还需要定义这个规则在运行过程中是否生效：")]),s._v(" "),e("ul",[e("li",[e("p",[s._v("运行过程中生效的硬策略："),e("code",[s._v("requiredDuringSchedulingRequiredDuringExecution")]),e("strong",[s._v("（计划中，未实现，现在版本还不支持）")])]),s._v(" "),e("ul",[e("li",[s._v("在调度期间必须满足规则，如果不能满足规则，则Pod不能被调度到对应的主机上")]),s._v(" "),e("li",[s._v("在之后的运行过程中，如果因为某些原因（比如修改label）导致规则不能满足，系统会尝试把Pod从主机上删除")])])]),s._v(" "),e("li",[e("p",[s._v("运行过程中不生效的硬策略："),e("code",[s._v("requiredDuringSchedulingIgnoredDuringExecution")])]),s._v(" "),e("ul",[e("li",[s._v("在调度期间必须满足规则，如果不能满足规则，则Pod不能被调度到对应的主机上")]),s._v(" "),e("li",[s._v("在之后的运行过程中，系统不会再检查这些规则是否满足")]),s._v(" "),e("li",[e("blockquote",[e("p",[s._v("为什么会有这种策略？根据一位核心开发人员在Issue中所写，"),e("code",[s._v("requiredDuringSchedulingIgnoredDuringExecution")]),s._v("的存在只是为"),e("code",[s._v("requiredDuringSchedulingRequiredDuringExecution")]),s._v("的开发争取时间。"),e("img",{attrs:{src:a(491),alt:"Issue评论"}}),e("code",[s._v("requiredDuringSchedulingRequiredDuringExecution")]),s._v("的开发似乎非常困难，这么多年了还没做好")])])])])]),s._v(" "),e("li",[e("p",[s._v("软策略："),e("code",[s._v("preferredDuringSchedulingIgnoredDuringExecution")])]),s._v(" "),e("ul",[e("li",[s._v("在调度期间尽量满足规则，如果不能满足规则，Pod也有可能被调度到对应的主机上")]),s._v(" "),e("li",[s._v("在之后的运行过程中，系统不会再检查这些规则是否满足")])])])]),s._v(" "),e("div",{staticClass:"language-yml line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-yml"}},[e("code",[e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("apiVersion")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" apps/v1\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("kind")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" Deployment\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("metadata")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("...")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("spec")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("...")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("template")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#Pod模板")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("metadata")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("...")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("spec")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("affinity")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("nodeAffinity")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#Node亲和性")]),s._v("\n          "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("requiredDuringSchedulingRequiredDuringExecution")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n            "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("...")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#运行过程中生效的硬策略（计划中，未实现）")]),s._v("\n          "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("requiredDuringSchedulingIgnoredDuringExecution")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n            "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("...")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#运行过程中不生效的硬策略")]),s._v("\n          "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("preferredDuringSchedulingIgnoredDuringExecution")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n            "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("...")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#软策略")]),s._v("\n        "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("podAffinity")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#Pod亲和性")]),s._v("\n          "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("requiredDuringSchedulingRequiredDuringExecution")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n            "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("...")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#运行过程中生效的硬策略（计划中，未实现）")]),s._v("\n          "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("requiredDuringSchedulingIgnoredDuringExecution")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n            "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("...")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#运行过程中不生效的硬策略")]),s._v("\n          "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("preferredDuringSchedulingIgnoredDuringExecution")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n            "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("...")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#软策略")]),s._v("\n        "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("podAntiAffinity")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#Pod反亲和性")]),s._v("\n          "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("requiredDuringSchedulingRequiredDuringExecution")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n            "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("...")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#运行过程中生效的硬策略（计划中，未实现）")]),s._v("\n          "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("requiredDuringSchedulingIgnoredDuringExecution")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n            "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("...")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#运行过程中不生效的硬策略")]),s._v("\n          "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("preferredDuringSchedulingIgnoredDuringExecution")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n            "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("...")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#软策略")]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("containers")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("...")]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("...")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br"),e("span",{staticClass:"line-number"},[s._v("26")]),e("br"),e("span",{staticClass:"line-number"},[s._v("27")]),e("br"),e("span",{staticClass:"line-number"},[s._v("28")]),e("br"),e("span",{staticClass:"line-number"},[s._v("29")]),e("br"),e("span",{staticClass:"line-number"},[s._v("30")]),e("br"),e("span",{staticClass:"line-number"},[s._v("31")]),e("br"),e("span",{staticClass:"line-number"},[s._v("32")]),e("br"),e("span",{staticClass:"line-number"},[s._v("33")]),e("br"),e("span",{staticClass:"line-number"},[s._v("34")]),e("br"),e("span",{staticClass:"line-number"},[s._v("35")]),e("br")])]),e("blockquote",[e("p",[s._v("这命名不觉得有点反人类吗？有点无语......")])]),s._v(" "),e("h3",{attrs:{id:"预选策略-硬策略-详解"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#预选策略-硬策略-详解"}},[s._v("#")]),s._v(" 预选策略/硬策略 详解")]),s._v(" "),e("p",[s._v("预选就是一系列逻辑表达式进行与运算，若结果为真，则选为候选节点。")]),s._v(" "),e("p",[s._v("对于"),e("span",{staticClass:"katex"},[e("span",{staticClass:"katex-mathml"},[e("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[e("semantics",[e("mrow",[e("mi",[s._v("K")])],1),e("annotation",{attrs:{encoding:"application/x-tex"}},[s._v("K")])],1)],1)],1),e("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[e("span",{staticClass:"base"},[e("span",{staticClass:"strut",staticStyle:{height:"0.68333em","vertical-align":"0em"}}),e("span",{staticClass:"mord mathdefault",staticStyle:{"margin-right":"0.07153em"}},[s._v("K")])])])]),s._v("个预选策略"),e("span",{staticClass:"katex"},[e("span",{staticClass:"katex-mathml"},[e("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[e("semantics",[e("mrow",[e("msub",[e("mi",[s._v("F")]),e("mi",[s._v("k")])],1),e("mo",{attrs:{stretchy:"false"}},[s._v("(")]),e("mo",[s._v("⋅")]),e("mo",{attrs:{stretchy:"false"}},[s._v(")")]),e("mo",{attrs:{stretchy:"false"}},[s._v("(")]),e("mn",[s._v("1")]),e("mo",[s._v("≤")]),e("mi",[s._v("k")]),e("mo",[s._v("≤")]),e("mi",[s._v("K")]),e("mo",{attrs:{stretchy:"false"}},[s._v(")")])],1),e("annotation",{attrs:{encoding:"application/x-tex"}},[s._v("F_k(\\cdot)(1\\leq k\\leq K)")])],1)],1)],1),e("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[e("span",{staticClass:"base"},[e("span",{staticClass:"strut",staticStyle:{height:"1em","vertical-align":"-0.25em"}}),e("span",{staticClass:"mord"},[e("span",{staticClass:"mord mathdefault",staticStyle:{"margin-right":"0.13889em"}},[s._v("F")]),e("span",{staticClass:"msupsub"},[e("span",{staticClass:"vlist-t vlist-t2"},[e("span",{staticClass:"vlist-r"},[e("span",{staticClass:"vlist",staticStyle:{height:"0.33610799999999996em"}},[e("span",{staticStyle:{top:"-2.5500000000000003em","margin-left":"-0.13889em","margin-right":"0.05em"}},[e("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),e("span",{staticClass:"sizing reset-size6 size3 mtight"},[e("span",{staticClass:"mord mathdefault mtight",staticStyle:{"margin-right":"0.03148em"}},[s._v("k")])])])]),e("span",{staticClass:"vlist-s"},[s._v("​")])]),e("span",{staticClass:"vlist-r"},[e("span",{staticClass:"vlist",staticStyle:{height:"0.15em"}},[e("span")])])])])]),e("span",{staticClass:"mopen"},[s._v("(")]),e("span",{staticClass:"mord"},[s._v("⋅")]),e("span",{staticClass:"mclose"},[s._v(")")]),e("span",{staticClass:"mopen"},[s._v("(")]),e("span",{staticClass:"mord"},[s._v("1")]),e("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}}),e("span",{staticClass:"mrel"},[s._v("≤")]),e("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}})]),e("span",{staticClass:"base"},[e("span",{staticClass:"strut",staticStyle:{height:"0.83041em","vertical-align":"-0.13597em"}}),e("span",{staticClass:"mord mathdefault",staticStyle:{"margin-right":"0.03148em"}},[s._v("k")]),e("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}}),e("span",{staticClass:"mrel"},[s._v("≤")]),e("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}})]),e("span",{staticClass:"base"},[e("span",{staticClass:"strut",staticStyle:{height:"1em","vertical-align":"-0.25em"}}),e("span",{staticClass:"mord mathdefault",staticStyle:{"margin-right":"0.07153em"}},[s._v("K")]),e("span",{staticClass:"mclose"},[s._v(")")])])])]),s._v("和系统内的全部节点集合"),e("span",{staticClass:"katex"},[e("span",{staticClass:"katex-mathml"},[e("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[e("semantics",[e("mrow",[e("msub",[e("mi",[s._v("N")]),e("mn",[s._v("0")])],1)],1),e("annotation",{attrs:{encoding:"application/x-tex"}},[s._v("N_0")])],1)],1)],1),e("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[e("span",{staticClass:"base"},[e("span",{staticClass:"strut",staticStyle:{height:"0.83333em","vertical-align":"-0.15em"}}),e("span",{staticClass:"mord"},[e("span",{staticClass:"mord mathdefault",staticStyle:{"margin-right":"0.10903em"}},[s._v("N")]),e("span",{staticClass:"msupsub"},[e("span",{staticClass:"vlist-t vlist-t2"},[e("span",{staticClass:"vlist-r"},[e("span",{staticClass:"vlist",staticStyle:{height:"0.30110799999999993em"}},[e("span",{staticStyle:{top:"-2.5500000000000003em","margin-left":"-0.10903em","margin-right":"0.05em"}},[e("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),e("span",{staticClass:"sizing reset-size6 size3 mtight"},[e("span",{staticClass:"mord mtight"},[s._v("0")])])])]),e("span",{staticClass:"vlist-s"},[s._v("​")])]),e("span",{staticClass:"vlist-r"},[e("span",{staticClass:"vlist",staticStyle:{height:"0.15em"}},[e("span")])])])])])])])]),s._v("，候选节点为符合预选策略的节点集合"),e("span",{staticClass:"katex"},[e("span",{staticClass:"katex-mathml"},[e("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[e("semantics",[e("mrow",[e("msub",[e("mi",[s._v("N")]),e("mn",[s._v("1")])],1),e("mo",[s._v("=")]),e("mo",{attrs:{stretchy:"false"}},[s._v("{")]),e("mi",[s._v("n")]),e("mo",[s._v("∈")]),e("msub",[e("mi",[s._v("N")]),e("mn",[s._v("0")])],1),e("mi",{attrs:{mathvariant:"normal"}},[s._v("∣")]),e("msubsup",[e("mo",[s._v("⋀")]),e("mrow",[e("mi",[s._v("k")]),e("mo",[s._v("=")]),e("mn",[s._v("1")])],1),e("mrow",[e("mi",[s._v("k")]),e("mo",[s._v("≤")]),e("mi",[s._v("K")])],1)],1),e("msub",[e("mi",[s._v("F")]),e("mi",[s._v("k")])],1),e("mo",{attrs:{stretchy:"false"}},[s._v("(")]),e("mi",[s._v("n")]),e("mo",{attrs:{stretchy:"false"}},[s._v(")")]),e("mo",{attrs:{stretchy:"false"}},[s._v("}")])],1),e("annotation",{attrs:{encoding:"application/x-tex"}},[s._v("N_1=\\{n\\in N_0|\\bigwedge_{k=1}^{k\\leq K}F_k(n)\\}")])],1)],1)],1),e("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[e("span",{staticClass:"base"},[e("span",{staticClass:"strut",staticStyle:{height:"0.83333em","vertical-align":"-0.15em"}}),e("span",{staticClass:"mord"},[e("span",{staticClass:"mord mathdefault",staticStyle:{"margin-right":"0.10903em"}},[s._v("N")]),e("span",{staticClass:"msupsub"},[e("span",{staticClass:"vlist-t vlist-t2"},[e("span",{staticClass:"vlist-r"},[e("span",{staticClass:"vlist",staticStyle:{height:"0.30110799999999993em"}},[e("span",{staticStyle:{top:"-2.5500000000000003em","margin-left":"-0.10903em","margin-right":"0.05em"}},[e("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),e("span",{staticClass:"sizing reset-size6 size3 mtight"},[e("span",{staticClass:"mord mtight"},[s._v("1")])])])]),e("span",{staticClass:"vlist-s"},[s._v("​")])]),e("span",{staticClass:"vlist-r"},[e("span",{staticClass:"vlist",staticStyle:{height:"0.15em"}},[e("span")])])])])]),e("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}}),e("span",{staticClass:"mrel"},[s._v("=")]),e("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}})]),e("span",{staticClass:"base"},[e("span",{staticClass:"strut",staticStyle:{height:"1em","vertical-align":"-0.25em"}}),e("span",{staticClass:"mopen"},[s._v("{")]),e("span",{staticClass:"mord mathdefault"},[s._v("n")]),e("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}}),e("span",{staticClass:"mrel"},[s._v("∈")]),e("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}})]),e("span",{staticClass:"base"},[e("span",{staticClass:"strut",staticStyle:{height:"1.2887179999999998em","vertical-align":"-0.29971000000000003em"}}),e("span",{staticClass:"mord"},[e("span",{staticClass:"mord mathdefault",staticStyle:{"margin-right":"0.10903em"}},[s._v("N")]),e("span",{staticClass:"msupsub"},[e("span",{staticClass:"vlist-t vlist-t2"},[e("span",{staticClass:"vlist-r"},[e("span",{staticClass:"vlist",staticStyle:{height:"0.30110799999999993em"}},[e("span",{staticStyle:{top:"-2.5500000000000003em","margin-left":"-0.10903em","margin-right":"0.05em"}},[e("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),e("span",{staticClass:"sizing reset-size6 size3 mtight"},[e("span",{staticClass:"mord mtight"},[s._v("0")])])])]),e("span",{staticClass:"vlist-s"},[s._v("​")])]),e("span",{staticClass:"vlist-r"},[e("span",{staticClass:"vlist",staticStyle:{height:"0.15em"}},[e("span")])])])])]),e("span",{staticClass:"mord"},[s._v("∣")]),e("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.16666666666666666em"}}),e("span",{staticClass:"mop"},[e("span",{staticClass:"mop op-symbol small-op",staticStyle:{position:"relative",top:"-0.0000050000000000050004em"}},[s._v("⋀")]),e("span",{staticClass:"msupsub"},[e("span",{staticClass:"vlist-t vlist-t2"},[e("span",{staticClass:"vlist-r"},[e("span",{staticClass:"vlist",staticStyle:{height:"0.9890079999999999em"}},[e("span",{staticStyle:{top:"-2.40029em","margin-left":"0em","margin-right":"0.05em"}},[e("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),e("span",{staticClass:"sizing reset-size6 size3 mtight"},[e("span",{staticClass:"mord mtight"},[e("span",{staticClass:"mord mathdefault mtight",staticStyle:{"margin-right":"0.03148em"}},[s._v("k")]),e("span",{staticClass:"mrel mtight"},[s._v("=")]),e("span",{staticClass:"mord mtight"},[s._v("1")])])])]),e("span",{staticStyle:{top:"-3.2029em","margin-right":"0.05em"}},[e("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),e("span",{staticClass:"sizing reset-size6 size3 mtight"},[e("span",{staticClass:"mord mtight"},[e("span",{staticClass:"mord mathdefault mtight",staticStyle:{"margin-right":"0.03148em"}},[s._v("k")]),e("span",{staticClass:"mrel mtight"},[s._v("≤")]),e("span",{staticClass:"mord mathdefault mtight",staticStyle:{"margin-right":"0.07153em"}},[s._v("K")])])])])]),e("span",{staticClass:"vlist-s"},[s._v("​")])]),e("span",{staticClass:"vlist-r"},[e("span",{staticClass:"vlist",staticStyle:{height:"0.29971000000000003em"}},[e("span")])])])])]),e("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.16666666666666666em"}}),e("span",{staticClass:"mord"},[e("span",{staticClass:"mord mathdefault",staticStyle:{"margin-right":"0.13889em"}},[s._v("F")]),e("span",{staticClass:"msupsub"},[e("span",{staticClass:"vlist-t vlist-t2"},[e("span",{staticClass:"vlist-r"},[e("span",{staticClass:"vlist",staticStyle:{height:"0.33610799999999996em"}},[e("span",{staticStyle:{top:"-2.5500000000000003em","margin-left":"-0.13889em","margin-right":"0.05em"}},[e("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),e("span",{staticClass:"sizing reset-size6 size3 mtight"},[e("span",{staticClass:"mord mathdefault mtight",staticStyle:{"margin-right":"0.03148em"}},[s._v("k")])])])]),e("span",{staticClass:"vlist-s"},[s._v("​")])]),e("span",{staticClass:"vlist-r"},[e("span",{staticClass:"vlist",staticStyle:{height:"0.15em"}},[e("span")])])])])]),e("span",{staticClass:"mopen"},[s._v("(")]),e("span",{staticClass:"mord mathdefault"},[s._v("n")]),e("span",{staticClass:"mclose"},[s._v(")")]),e("span",{staticClass:"mclose"},[s._v("}")])])])]),s._v("。")]),s._v(" "),e("p",[s._v("预选策略的种类：")]),s._v(" "),e("ul",[e("li",[s._v("MatchNodeSelector（即上文中的"),e("code",[s._v("nodeSelector")]),s._v("调度）：看节点标签能否适配Pod定义的nodeSelector")]),s._v(" "),e("li",[s._v("GeneralPred HostName：如果Pod定义"),e("code",[s._v("hostname")]),s._v("属性，会检查节点是否匹配"),e("code",[s._v("pod.spec.hostname")])]),s._v(" "),e("li",[s._v("PodFitsHostPorts：根据"),e("code",[s._v("pod.spec.containers.ports.hostPort")]),s._v("检查pod要暴露的端口是否被占用。")]),s._v(" "),e("li",[s._v("CheckNodeConditionPred：检查节点是否正常")]),s._v(" "),e("li",[s._v("PodFitsResources：判断节点的资源能够满足Pod的"),e("code",[s._v("pod.spec.containers.resources")]),s._v("定义")]),s._v(" "),e("li",[s._v("NoDiskConflict：判断Pod定义的存储是否在node节点上使用。（默认没有启用）")]),s._v(" "),e("li",[s._v("PodToleratesNodeTaints：检查pod上Tolerates的能否容忍污点（"),e("code",[s._v("pod.spec.tolerations")]),s._v("，下文介绍）")]),s._v(" "),e("li",[s._v("CheckNodeLabelPresence：检查节点上的标志是否存在 （默认没有启动）")]),s._v(" "),e("li",[s._v("CheckServiceAffinity：根据Pod所属的"),e("code",[s._v("service")]),s._v("。将相同"),e("code",[s._v("service")]),s._v("上的Pod尽量放到同一个节点（默认没有启动）")]),s._v(" "),e("li",[s._v("CheckVolumeBinding：检查是否可以绑定挂载点（默认没有启动）")]),s._v(" "),e("li",[s._v("NoVolumeZoneConflict：检查是挂载区域冲突（默认没有启动）")]),s._v(" "),e("li",[s._v("CheckNodeMemoryPressure：检查内存是否存在压力")]),s._v(" "),e("li",[s._v("CheckNodeDiskPressure：检查磁盘IO压力是否过大")]),s._v(" "),e("li",[s._v("CheckNodePIDPressure：检查pid资源是否过大")])]),s._v(" "),e("h3",{attrs:{id:"优选策略-软策略-详解"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#优选策略-软策略-详解"}},[s._v("#")]),s._v(" 优选策略/软策略 详解")]),s._v(" "),e("p",[s._v("优选策略由一系列带权重的逻辑表达式构成，其权重值的范围是1-100，若逻辑为真则加分，否则不加分，最后选出分数最高的节点。")]),s._v(" "),e("p",[s._v("若有"),e("span",{staticClass:"katex"},[e("span",{staticClass:"katex-mathml"},[e("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[e("semantics",[e("mrow",[e("mi",[s._v("L")])],1),e("annotation",{attrs:{encoding:"application/x-tex"}},[s._v("L")])],1)],1)],1),e("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[e("span",{staticClass:"base"},[e("span",{staticClass:"strut",staticStyle:{height:"0.68333em","vertical-align":"0em"}}),e("span",{staticClass:"mord mathdefault"},[s._v("L")])])])]),s._v("个由逻辑表达式"),e("span",{staticClass:"katex"},[e("span",{staticClass:"katex-mathml"},[e("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[e("semantics",[e("mrow",[e("msub",[e("mi",[s._v("G")]),e("mi",[s._v("l")])],1),e("mo",{attrs:{stretchy:"false"}},[s._v("(")]),e("mo",[s._v("⋅")]),e("mo",{attrs:{stretchy:"false"}},[s._v(")")])],1),e("annotation",{attrs:{encoding:"application/x-tex"}},[s._v("G_l(\\cdot)")])],1)],1)],1),e("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[e("span",{staticClass:"base"},[e("span",{staticClass:"strut",staticStyle:{height:"1em","vertical-align":"-0.25em"}}),e("span",{staticClass:"mord"},[e("span",{staticClass:"mord mathdefault"},[s._v("G")]),e("span",{staticClass:"msupsub"},[e("span",{staticClass:"vlist-t vlist-t2"},[e("span",{staticClass:"vlist-r"},[e("span",{staticClass:"vlist",staticStyle:{height:"0.33610799999999996em"}},[e("span",{staticStyle:{top:"-2.5500000000000003em","margin-left":"0em","margin-right":"0.05em"}},[e("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),e("span",{staticClass:"sizing reset-size6 size3 mtight"},[e("span",{staticClass:"mord mathdefault mtight",staticStyle:{"margin-right":"0.01968em"}},[s._v("l")])])])]),e("span",{staticClass:"vlist-s"},[s._v("​")])]),e("span",{staticClass:"vlist-r"},[e("span",{staticClass:"vlist",staticStyle:{height:"0.15em"}},[e("span")])])])])]),e("span",{staticClass:"mopen"},[s._v("(")]),e("span",{staticClass:"mord"},[s._v("⋅")]),e("span",{staticClass:"mclose"},[s._v(")")])])])]),s._v("和权重"),e("span",{staticClass:"katex"},[e("span",{staticClass:"katex-mathml"},[e("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[e("semantics",[e("mrow",[e("msub",[e("mi",[s._v("w")]),e("mi",[s._v("l")])],1),e("mo",{attrs:{stretchy:"false"}},[s._v("(")]),e("mn",[s._v("1")]),e("mo",[s._v("≤")]),e("msub",[e("mi",[s._v("w")]),e("mi",[s._v("l")])],1),e("mo",[s._v("≤")]),e("mn",[s._v("100")]),e("mo",{attrs:{stretchy:"false"}},[s._v(")")])],1),e("annotation",{attrs:{encoding:"application/x-tex"}},[s._v("w_l(1\\leq w_l\\leq 100)")])],1)],1)],1),e("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[e("span",{staticClass:"base"},[e("span",{staticClass:"strut",staticStyle:{height:"1em","vertical-align":"-0.25em"}}),e("span",{staticClass:"mord"},[e("span",{staticClass:"mord mathdefault",staticStyle:{"margin-right":"0.02691em"}},[s._v("w")]),e("span",{staticClass:"msupsub"},[e("span",{staticClass:"vlist-t vlist-t2"},[e("span",{staticClass:"vlist-r"},[e("span",{staticClass:"vlist",staticStyle:{height:"0.33610799999999996em"}},[e("span",{staticStyle:{top:"-2.5500000000000003em","margin-left":"-0.02691em","margin-right":"0.05em"}},[e("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),e("span",{staticClass:"sizing reset-size6 size3 mtight"},[e("span",{staticClass:"mord mathdefault mtight",staticStyle:{"margin-right":"0.01968em"}},[s._v("l")])])])]),e("span",{staticClass:"vlist-s"},[s._v("​")])]),e("span",{staticClass:"vlist-r"},[e("span",{staticClass:"vlist",staticStyle:{height:"0.15em"}},[e("span")])])])])]),e("span",{staticClass:"mopen"},[s._v("(")]),e("span",{staticClass:"mord"},[s._v("1")]),e("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}}),e("span",{staticClass:"mrel"},[s._v("≤")]),e("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}})]),e("span",{staticClass:"base"},[e("span",{staticClass:"strut",staticStyle:{height:"0.7859700000000001em","vertical-align":"-0.15em"}}),e("span",{staticClass:"mord"},[e("span",{staticClass:"mord mathdefault",staticStyle:{"margin-right":"0.02691em"}},[s._v("w")]),e("span",{staticClass:"msupsub"},[e("span",{staticClass:"vlist-t vlist-t2"},[e("span",{staticClass:"vlist-r"},[e("span",{staticClass:"vlist",staticStyle:{height:"0.33610799999999996em"}},[e("span",{staticStyle:{top:"-2.5500000000000003em","margin-left":"-0.02691em","margin-right":"0.05em"}},[e("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),e("span",{staticClass:"sizing reset-size6 size3 mtight"},[e("span",{staticClass:"mord mathdefault mtight",staticStyle:{"margin-right":"0.01968em"}},[s._v("l")])])])]),e("span",{staticClass:"vlist-s"},[s._v("​")])]),e("span",{staticClass:"vlist-r"},[e("span",{staticClass:"vlist",staticStyle:{height:"0.15em"}},[e("span")])])])])]),e("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}}),e("span",{staticClass:"mrel"},[s._v("≤")]),e("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}})]),e("span",{staticClass:"base"},[e("span",{staticClass:"strut",staticStyle:{height:"1em","vertical-align":"-0.25em"}}),e("span",{staticClass:"mord"},[s._v("1")]),e("span",{staticClass:"mord"},[s._v("0")]),e("span",{staticClass:"mord"},[s._v("0")]),e("span",{staticClass:"mclose"},[s._v(")")])])])]),s._v("组成的优选策略"),e("span",{staticClass:"katex"},[e("span",{staticClass:"katex-mathml"},[e("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[e("semantics",[e("mrow",[e("msub",[e("mi",[s._v("H")]),e("mi",[s._v("l")])],1),e("mo",{attrs:{stretchy:"false"}},[s._v("(")]),e("mi",[s._v("n")]),e("mo",{attrs:{stretchy:"false"}},[s._v(")")])],1),e("annotation",{attrs:{encoding:"application/x-tex"}},[s._v("H_l(n)")])],1)],1)],1),e("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[e("span",{staticClass:"base"},[e("span",{staticClass:"strut",staticStyle:{height:"1em","vertical-align":"-0.25em"}}),e("span",{staticClass:"mord"},[e("span",{staticClass:"mord mathdefault",staticStyle:{"margin-right":"0.08125em"}},[s._v("H")]),e("span",{staticClass:"msupsub"},[e("span",{staticClass:"vlist-t vlist-t2"},[e("span",{staticClass:"vlist-r"},[e("span",{staticClass:"vlist",staticStyle:{height:"0.33610799999999996em"}},[e("span",{staticStyle:{top:"-2.5500000000000003em","margin-left":"-0.08125em","margin-right":"0.05em"}},[e("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),e("span",{staticClass:"sizing reset-size6 size3 mtight"},[e("span",{staticClass:"mord mathdefault mtight",staticStyle:{"margin-right":"0.01968em"}},[s._v("l")])])])]),e("span",{staticClass:"vlist-s"},[s._v("​")])]),e("span",{staticClass:"vlist-r"},[e("span",{staticClass:"vlist",staticStyle:{height:"0.15em"}},[e("span")])])])])]),e("span",{staticClass:"mopen"},[s._v("(")]),e("span",{staticClass:"mord mathdefault"},[s._v("n")]),e("span",{staticClass:"mclose"},[s._v(")")])])])]),s._v("：")]),s._v(" "),e("p",[e("span",{staticClass:"katex-display"},[e("span",{staticClass:"katex"},[e("span",{staticClass:"katex-mathml"},[e("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[e("semantics",[e("mrow",[e("msub",[e("mi",[s._v("H")]),e("mi",[s._v("l")])],1),e("mo",{attrs:{stretchy:"false"}},[s._v("(")]),e("mi",[s._v("n")]),e("mo",{attrs:{stretchy:"false"}},[s._v(")")]),e("mo",[s._v("=")]),e("mrow",[e("mo",{attrs:{fence:"true"}},[s._v("{")]),e("mtable",{attrs:{rowspacing:"0.24999999999999992em",columnalign:"right left right",columnspacing:"0em 1em"}},[e("mtr",[e("mtd",[e("mstyle",{attrs:{scriptlevel:"0",displaystyle:"true"}},[e("msub",[e("mi",[s._v("w")]),e("mi",[s._v("l")])],1)],1)],1),e("mtd",[e("mstyle",{attrs:{scriptlevel:"0",displaystyle:"true"}},[e("mrow",[e("mrow"),e("mspace",{attrs:{width:"2em"}})],1)],1)],1),e("mtd",[e("mstyle",{attrs:{scriptlevel:"0",displaystyle:"true"}},[e("mrow",[e("mo",{attrs:{stretchy:"false"}},[s._v("(")]),e("msub",[e("mi",[s._v("G")]),e("mi",[s._v("l")])],1),e("mo",{attrs:{stretchy:"false"}},[s._v("(")]),e("mi",[s._v("n")]),e("mo",{attrs:{stretchy:"false"}},[s._v(")")]),e("mo",{attrs:{stretchy:"false"}},[s._v(")")])],1)],1)],1)],1),e("mtr",[e("mtd",[e("mstyle",{attrs:{scriptlevel:"0",displaystyle:"true"}},[e("mn",[s._v("0")])],1)],1),e("mtd",[e("mstyle",{attrs:{scriptlevel:"0",displaystyle:"true"}},[e("mrow",[e("mrow"),e("mspace",{attrs:{width:"2em"}})],1)],1)],1),e("mtd",[e("mstyle",{attrs:{scriptlevel:"0",displaystyle:"true"}},[e("mrow",[e("mo",{attrs:{stretchy:"false"}},[s._v("(")]),e("mi",{attrs:{mathvariant:"normal"}},[s._v("¬")]),e("msub",[e("mi",[s._v("G")]),e("mi",[s._v("l")])],1),e("mo",{attrs:{stretchy:"false"}},[s._v("(")]),e("mi",[s._v("n")]),e("mo",{attrs:{stretchy:"false"}},[s._v(")")]),e("mo",{attrs:{stretchy:"false"}},[s._v(")")])],1)],1)],1)],1)],1)],1)],1),e("annotation",{attrs:{encoding:"application/x-tex"}},[s._v("H_l(n)=\\left\\{\n  \\begin{aligned}\n    w_l &\\qquad&  (G_l(n))\\\\\n    0 & \\qquad&(\\neg G_l(n))\\\\\n  \\end{aligned}\n  \\right.\n")])],1)],1)],1),e("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[e("span",{staticClass:"base"},[e("span",{staticClass:"strut",staticStyle:{height:"1em","vertical-align":"-0.25em"}}),e("span",{staticClass:"mord"},[e("span",{staticClass:"mord mathdefault",staticStyle:{"margin-right":"0.08125em"}},[s._v("H")]),e("span",{staticClass:"msupsub"},[e("span",{staticClass:"vlist-t vlist-t2"},[e("span",{staticClass:"vlist-r"},[e("span",{staticClass:"vlist",staticStyle:{height:"0.33610799999999996em"}},[e("span",{staticStyle:{top:"-2.5500000000000003em","margin-left":"-0.08125em","margin-right":"0.05em"}},[e("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),e("span",{staticClass:"sizing reset-size6 size3 mtight"},[e("span",{staticClass:"mord mathdefault mtight",staticStyle:{"margin-right":"0.01968em"}},[s._v("l")])])])]),e("span",{staticClass:"vlist-s"},[s._v("​")])]),e("span",{staticClass:"vlist-r"},[e("span",{staticClass:"vlist",staticStyle:{height:"0.15em"}},[e("span")])])])])]),e("span",{staticClass:"mopen"},[s._v("(")]),e("span",{staticClass:"mord mathdefault"},[s._v("n")]),e("span",{staticClass:"mclose"},[s._v(")")]),e("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}}),e("span",{staticClass:"mrel"},[s._v("=")]),e("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}})]),e("span",{staticClass:"base"},[e("span",{staticClass:"strut",staticStyle:{height:"3.00003em","vertical-align":"-1.25003em"}}),e("span",{staticClass:"minner"},[e("span",{staticClass:"mopen delimcenter",staticStyle:{top:"0em"}},[e("span",{staticClass:"delimsizing size4"},[s._v("{")])]),e("span",{staticClass:"mord"},[e("span",{staticClass:"mtable"},[e("span",{staticClass:"col-align-r"},[e("span",{staticClass:"vlist-t vlist-t2"},[e("span",{staticClass:"vlist-r"},[e("span",{staticClass:"vlist",staticStyle:{height:"1.7500000000000002em"}},[e("span",{staticStyle:{top:"-3.91em"}},[e("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),e("span",{staticClass:"mord"},[e("span",{staticClass:"mord"},[e("span",{staticClass:"mord mathdefault",staticStyle:{"margin-right":"0.02691em"}},[s._v("w")]),e("span",{staticClass:"msupsub"},[e("span",{staticClass:"vlist-t vlist-t2"},[e("span",{staticClass:"vlist-r"},[e("span",{staticClass:"vlist",staticStyle:{height:"0.33610799999999996em"}},[e("span",{staticStyle:{top:"-2.5500000000000003em","margin-left":"-0.02691em","margin-right":"0.05em"}},[e("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),e("span",{staticClass:"sizing reset-size6 size3 mtight"},[e("span",{staticClass:"mord mathdefault mtight",staticStyle:{"margin-right":"0.01968em"}},[s._v("l")])])])]),e("span",{staticClass:"vlist-s"},[s._v("​")])]),e("span",{staticClass:"vlist-r"},[e("span",{staticClass:"vlist",staticStyle:{height:"0.15em"}},[e("span")])])])])])])]),e("span",{staticStyle:{top:"-2.41em"}},[e("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),e("span",{staticClass:"mord"},[e("span",{staticClass:"mord"},[s._v("0")])])])]),e("span",{staticClass:"vlist-s"},[s._v("​")])]),e("span",{staticClass:"vlist-r"},[e("span",{staticClass:"vlist",staticStyle:{height:"1.2500000000000002em"}},[e("span")])])])]),e("span",{staticClass:"col-align-l"},[e("span",{staticClass:"vlist-t vlist-t2"},[e("span",{staticClass:"vlist-r"},[e("span",{staticClass:"vlist",staticStyle:{height:"1.7500000000000002em"}},[e("span",{staticStyle:{top:"-3.75em"}},[e("span",{staticClass:"pstrut",staticStyle:{height:"2.84em"}}),e("span",{staticClass:"mord"},[e("span",{staticClass:"mord"}),e("span",{staticClass:"mspace",staticStyle:{"margin-right":"2em"}})])]),e("span",{staticStyle:{top:"-2.25em"}},[e("span",{staticClass:"pstrut",staticStyle:{height:"2.84em"}}),e("span",{staticClass:"mord"},[e("span",{staticClass:"mord"}),e("span",{staticClass:"mspace",staticStyle:{"margin-right":"2em"}})])])]),e("span",{staticClass:"vlist-s"},[s._v("​")])]),e("span",{staticClass:"vlist-r"},[e("span",{staticClass:"vlist",staticStyle:{height:"1.2500000000000002em"}},[e("span")])])])]),e("span",{staticClass:"arraycolsep",staticStyle:{width:"1em"}}),e("span",{staticClass:"col-align-r"},[e("span",{staticClass:"vlist-t vlist-t2"},[e("span",{staticClass:"vlist-r"},[e("span",{staticClass:"vlist",staticStyle:{height:"1.7500000000000002em"}},[e("span",{staticStyle:{top:"-3.91em"}},[e("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),e("span",{staticClass:"mord"},[e("span",{staticClass:"mopen"},[s._v("(")]),e("span",{staticClass:"mord"},[e("span",{staticClass:"mord mathdefault"},[s._v("G")]),e("span",{staticClass:"msupsub"},[e("span",{staticClass:"vlist-t vlist-t2"},[e("span",{staticClass:"vlist-r"},[e("span",{staticClass:"vlist",staticStyle:{height:"0.33610799999999996em"}},[e("span",{staticStyle:{top:"-2.5500000000000003em","margin-left":"0em","margin-right":"0.05em"}},[e("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),e("span",{staticClass:"sizing reset-size6 size3 mtight"},[e("span",{staticClass:"mord mathdefault mtight",staticStyle:{"margin-right":"0.01968em"}},[s._v("l")])])])]),e("span",{staticClass:"vlist-s"},[s._v("​")])]),e("span",{staticClass:"vlist-r"},[e("span",{staticClass:"vlist",staticStyle:{height:"0.15em"}},[e("span")])])])])]),e("span",{staticClass:"mopen"},[s._v("(")]),e("span",{staticClass:"mord mathdefault"},[s._v("n")]),e("span",{staticClass:"mclose"},[s._v(")")]),e("span",{staticClass:"mclose"},[s._v(")")])])]),e("span",{staticStyle:{top:"-2.41em"}},[e("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),e("span",{staticClass:"mord"},[e("span",{staticClass:"mopen"},[s._v("(")]),e("span",{staticClass:"mord"},[s._v("¬")]),e("span",{staticClass:"mord"},[e("span",{staticClass:"mord mathdefault"},[s._v("G")]),e("span",{staticClass:"msupsub"},[e("span",{staticClass:"vlist-t vlist-t2"},[e("span",{staticClass:"vlist-r"},[e("span",{staticClass:"vlist",staticStyle:{height:"0.33610799999999996em"}},[e("span",{staticStyle:{top:"-2.5500000000000003em","margin-left":"0em","margin-right":"0.05em"}},[e("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),e("span",{staticClass:"sizing reset-size6 size3 mtight"},[e("span",{staticClass:"mord mathdefault mtight",staticStyle:{"margin-right":"0.01968em"}},[s._v("l")])])])]),e("span",{staticClass:"vlist-s"},[s._v("​")])]),e("span",{staticClass:"vlist-r"},[e("span",{staticClass:"vlist",staticStyle:{height:"0.15em"}},[e("span")])])])])]),e("span",{staticClass:"mopen"},[s._v("(")]),e("span",{staticClass:"mord mathdefault"},[s._v("n")]),e("span",{staticClass:"mclose"},[s._v(")")]),e("span",{staticClass:"mclose"},[s._v(")")])])])]),e("span",{staticClass:"vlist-s"},[s._v("​")])]),e("span",{staticClass:"vlist-r"},[e("span",{staticClass:"vlist",staticStyle:{height:"1.2500000000000002em"}},[e("span")])])])])])]),e("span",{staticClass:"mclose nulldelimiter"})])])])])])]),s._v(" "),e("p",[e("span",{staticClass:"katex-display"},[e("span",{staticClass:"katex"},[e("span",{staticClass:"katex-mathml"},[e("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[e("semantics",[e("mrow",[e("mn",[s._v("1")]),e("mo",[s._v("≤")]),e("mi",[s._v("l")]),e("mo",[s._v("≤")]),e("mi",[s._v("L")])],1),e("annotation",{attrs:{encoding:"application/x-tex"}},[s._v("1\\leq l\\leq L\n")])],1)],1)],1),e("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[e("span",{staticClass:"base"},[e("span",{staticClass:"strut",staticStyle:{height:"0.78041em","vertical-align":"-0.13597em"}}),e("span",{staticClass:"mord"},[s._v("1")]),e("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}}),e("span",{staticClass:"mrel"},[s._v("≤")]),e("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}})]),e("span",{staticClass:"base"},[e("span",{staticClass:"strut",staticStyle:{height:"0.83041em","vertical-align":"-0.13597em"}}),e("span",{staticClass:"mord mathdefault",staticStyle:{"margin-right":"0.01968em"}},[s._v("l")]),e("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}}),e("span",{staticClass:"mrel"},[s._v("≤")]),e("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}})]),e("span",{staticClass:"base"},[e("span",{staticClass:"strut",staticStyle:{height:"0.68333em","vertical-align":"0em"}}),e("span",{staticClass:"mord mathdefault"},[s._v("L")])])])])])]),s._v(" "),e("p",[s._v("则预选结果"),e("span",{staticClass:"katex"},[e("span",{staticClass:"katex-mathml"},[e("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[e("semantics",[e("mrow",[e("msub",[e("mi",[s._v("N")]),e("mn",[s._v("1")])],1)],1),e("annotation",{attrs:{encoding:"application/x-tex"}},[s._v("N_1")])],1)],1)],1),e("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[e("span",{staticClass:"base"},[e("span",{staticClass:"strut",staticStyle:{height:"0.83333em","vertical-align":"-0.15em"}}),e("span",{staticClass:"mord"},[e("span",{staticClass:"mord mathdefault",staticStyle:{"margin-right":"0.10903em"}},[s._v("N")]),e("span",{staticClass:"msupsub"},[e("span",{staticClass:"vlist-t vlist-t2"},[e("span",{staticClass:"vlist-r"},[e("span",{staticClass:"vlist",staticStyle:{height:"0.30110799999999993em"}},[e("span",{staticStyle:{top:"-2.5500000000000003em","margin-left":"-0.10903em","margin-right":"0.05em"}},[e("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),e("span",{staticClass:"sizing reset-size6 size3 mtight"},[e("span",{staticClass:"mord mtight"},[s._v("1")])])])]),e("span",{staticClass:"vlist-s"},[s._v("​")])]),e("span",{staticClass:"vlist-r"},[e("span",{staticClass:"vlist",staticStyle:{height:"0.15em"}},[e("span")])])])])])])])]),s._v("中的每个节点都会有一个得分"),e("span",{staticClass:"katex"},[e("span",{staticClass:"katex-mathml"},[e("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[e("semantics",[e("mrow",[e("mi",[s._v("S")]),e("mo",{attrs:{stretchy:"false"}},[s._v("(")]),e("mi",[s._v("n")]),e("mo",{attrs:{stretchy:"false"}},[s._v(")")]),e("mo",[s._v("=")]),e("msubsup",[e("mo",[s._v("∑")]),e("mrow",[e("mi",[s._v("l")]),e("mo",[s._v("=")]),e("mn",[s._v("1")])],1),e("mrow",[e("mi",[s._v("l")]),e("mo",[s._v("≤")]),e("mi",[s._v("L")])],1)],1),e("msub",[e("mi",[s._v("H")]),e("mi",[s._v("l")])],1),e("mo",{attrs:{stretchy:"false"}},[s._v("(")]),e("mi",[s._v("n")]),e("mo",{attrs:{stretchy:"false"}},[s._v(")")]),e("mo",{attrs:{stretchy:"false"}},[s._v("(")]),e("mi",[s._v("n")]),e("mo",[s._v("∈")]),e("msub",[e("mi",[s._v("N")]),e("mn",[s._v("1")])],1),e("mo",{attrs:{stretchy:"false"}},[s._v(")")])],1),e("annotation",{attrs:{encoding:"application/x-tex"}},[s._v("S(n)=\\sum_{l=1}^{l\\leq L}H_l(n)(n\\in N_1)")])],1)],1)],1),e("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[e("span",{staticClass:"base"},[e("span",{staticClass:"strut",staticStyle:{height:"1em","vertical-align":"-0.25em"}}),e("span",{staticClass:"mord mathdefault",staticStyle:{"margin-right":"0.05764em"}},[s._v("S")]),e("span",{staticClass:"mopen"},[s._v("(")]),e("span",{staticClass:"mord mathdefault"},[s._v("n")]),e("span",{staticClass:"mclose"},[s._v(")")]),e("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}}),e("span",{staticClass:"mrel"},[s._v("=")]),e("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}})]),e("span",{staticClass:"base"},[e("span",{staticClass:"strut",staticStyle:{height:"1.2887179999999998em","vertical-align":"-0.29971000000000003em"}}),e("span",{staticClass:"mop"},[e("span",{staticClass:"mop op-symbol small-op",staticStyle:{position:"relative",top:"-0.0000050000000000050004em"}},[s._v("∑")]),e("span",{staticClass:"msupsub"},[e("span",{staticClass:"vlist-t vlist-t2"},[e("span",{staticClass:"vlist-r"},[e("span",{staticClass:"vlist",staticStyle:{height:"0.9890079999999999em"}},[e("span",{staticStyle:{top:"-2.40029em","margin-left":"0em","margin-right":"0.05em"}},[e("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),e("span",{staticClass:"sizing reset-size6 size3 mtight"},[e("span",{staticClass:"mord mtight"},[e("span",{staticClass:"mord mathdefault mtight",staticStyle:{"margin-right":"0.01968em"}},[s._v("l")]),e("span",{staticClass:"mrel mtight"},[s._v("=")]),e("span",{staticClass:"mord mtight"},[s._v("1")])])])]),e("span",{staticStyle:{top:"-3.2029em","margin-right":"0.05em"}},[e("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),e("span",{staticClass:"sizing reset-size6 size3 mtight"},[e("span",{staticClass:"mord mtight"},[e("span",{staticClass:"mord mathdefault mtight",staticStyle:{"margin-right":"0.01968em"}},[s._v("l")]),e("span",{staticClass:"mrel mtight"},[s._v("≤")]),e("span",{staticClass:"mord mathdefault mtight"},[s._v("L")])])])])]),e("span",{staticClass:"vlist-s"},[s._v("​")])]),e("span",{staticClass:"vlist-r"},[e("span",{staticClass:"vlist",staticStyle:{height:"0.29971000000000003em"}},[e("span")])])])])]),e("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.16666666666666666em"}}),e("span",{staticClass:"mord"},[e("span",{staticClass:"mord mathdefault",staticStyle:{"margin-right":"0.08125em"}},[s._v("H")]),e("span",{staticClass:"msupsub"},[e("span",{staticClass:"vlist-t vlist-t2"},[e("span",{staticClass:"vlist-r"},[e("span",{staticClass:"vlist",staticStyle:{height:"0.33610799999999996em"}},[e("span",{staticStyle:{top:"-2.5500000000000003em","margin-left":"-0.08125em","margin-right":"0.05em"}},[e("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),e("span",{staticClass:"sizing reset-size6 size3 mtight"},[e("span",{staticClass:"mord mathdefault mtight",staticStyle:{"margin-right":"0.01968em"}},[s._v("l")])])])]),e("span",{staticClass:"vlist-s"},[s._v("​")])]),e("span",{staticClass:"vlist-r"},[e("span",{staticClass:"vlist",staticStyle:{height:"0.15em"}},[e("span")])])])])]),e("span",{staticClass:"mopen"},[s._v("(")]),e("span",{staticClass:"mord mathdefault"},[s._v("n")]),e("span",{staticClass:"mclose"},[s._v(")")]),e("span",{staticClass:"mopen"},[s._v("(")]),e("span",{staticClass:"mord mathdefault"},[s._v("n")]),e("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}}),e("span",{staticClass:"mrel"},[s._v("∈")]),e("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}})]),e("span",{staticClass:"base"},[e("span",{staticClass:"strut",staticStyle:{height:"1em","vertical-align":"-0.25em"}}),e("span",{staticClass:"mord"},[e("span",{staticClass:"mord mathdefault",staticStyle:{"margin-right":"0.10903em"}},[s._v("N")]),e("span",{staticClass:"msupsub"},[e("span",{staticClass:"vlist-t vlist-t2"},[e("span",{staticClass:"vlist-r"},[e("span",{staticClass:"vlist",staticStyle:{height:"0.30110799999999993em"}},[e("span",{staticStyle:{top:"-2.5500000000000003em","margin-left":"-0.10903em","margin-right":"0.05em"}},[e("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),e("span",{staticClass:"sizing reset-size6 size3 mtight"},[e("span",{staticClass:"mord mtight"},[s._v("1")])])])]),e("span",{staticClass:"vlist-s"},[s._v("​")])]),e("span",{staticClass:"vlist-r"},[e("span",{staticClass:"vlist",staticStyle:{height:"0.15em"}},[e("span")])])])])]),e("span",{staticClass:"mclose"},[s._v(")")])])])]),s._v("。")]),s._v(" "),e("p",[s._v("则优选结果为得分最高的节点集合"),e("span",{staticClass:"katex"},[e("span",{staticClass:"katex-mathml"},[e("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[e("semantics",[e("mrow",[e("msub",[e("mi",[s._v("N")]),e("mn",[s._v("2")])],1),e("mo",[s._v("=")]),e("mo",{attrs:{stretchy:"false"}},[s._v("{")]),e("mi",[s._v("n")]),e("mo",[s._v("∈")]),e("msub",[e("mi",[s._v("N")]),e("mn",[s._v("1")])],1),e("mi",{attrs:{mathvariant:"normal"}},[s._v("∣")]),e("mi",[s._v("S")]),e("mo",{attrs:{stretchy:"false"}},[s._v("(")]),e("mi",[s._v("n")]),e("mo",{attrs:{stretchy:"false"}},[s._v(")")]),e("mo",[s._v("=")]),e("mi",[s._v("max")]),e("mo",[s._v("⁡")]),e("mrow",[e("mo",{attrs:{stretchy:"false"}},[s._v("(")]),e("mo",{attrs:{stretchy:"false"}},[s._v("{")]),e("mi",[s._v("S")]),e("mo",{attrs:{stretchy:"false"}},[s._v("(")]),e("mi",[s._v("n")]),e("mo",{attrs:{stretchy:"false"}},[s._v(")")]),e("mi",{attrs:{mathvariant:"normal"}},[s._v("∣")]),e("mi",[s._v("n")]),e("mo",[s._v("∈")]),e("msub",[e("mi",[s._v("N")]),e("mn",[s._v("1")])],1),e("mo",{attrs:{stretchy:"false"}},[s._v("}")]),e("mo",{attrs:{stretchy:"false"}},[s._v(")")])],1),e("mo",{attrs:{stretchy:"false"}},[s._v("}")])],1),e("annotation",{attrs:{encoding:"application/x-tex"}},[s._v("N_2=\\{n\\in N_1|S(n)=\\max{(\\{S(n)|n\\in N_1\\})}\\}")])],1)],1)],1),e("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[e("span",{staticClass:"base"},[e("span",{staticClass:"strut",staticStyle:{height:"0.83333em","vertical-align":"-0.15em"}}),e("span",{staticClass:"mord"},[e("span",{staticClass:"mord mathdefault",staticStyle:{"margin-right":"0.10903em"}},[s._v("N")]),e("span",{staticClass:"msupsub"},[e("span",{staticClass:"vlist-t vlist-t2"},[e("span",{staticClass:"vlist-r"},[e("span",{staticClass:"vlist",staticStyle:{height:"0.30110799999999993em"}},[e("span",{staticStyle:{top:"-2.5500000000000003em","margin-left":"-0.10903em","margin-right":"0.05em"}},[e("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),e("span",{staticClass:"sizing reset-size6 size3 mtight"},[e("span",{staticClass:"mord mtight"},[s._v("2")])])])]),e("span",{staticClass:"vlist-s"},[s._v("​")])]),e("span",{staticClass:"vlist-r"},[e("span",{staticClass:"vlist",staticStyle:{height:"0.15em"}},[e("span")])])])])]),e("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}}),e("span",{staticClass:"mrel"},[s._v("=")]),e("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}})]),e("span",{staticClass:"base"},[e("span",{staticClass:"strut",staticStyle:{height:"1em","vertical-align":"-0.25em"}}),e("span",{staticClass:"mopen"},[s._v("{")]),e("span",{staticClass:"mord mathdefault"},[s._v("n")]),e("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}}),e("span",{staticClass:"mrel"},[s._v("∈")]),e("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}})]),e("span",{staticClass:"base"},[e("span",{staticClass:"strut",staticStyle:{height:"1em","vertical-align":"-0.25em"}}),e("span",{staticClass:"mord"},[e("span",{staticClass:"mord mathdefault",staticStyle:{"margin-right":"0.10903em"}},[s._v("N")]),e("span",{staticClass:"msupsub"},[e("span",{staticClass:"vlist-t vlist-t2"},[e("span",{staticClass:"vlist-r"},[e("span",{staticClass:"vlist",staticStyle:{height:"0.30110799999999993em"}},[e("span",{staticStyle:{top:"-2.5500000000000003em","margin-left":"-0.10903em","margin-right":"0.05em"}},[e("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),e("span",{staticClass:"sizing reset-size6 size3 mtight"},[e("span",{staticClass:"mord mtight"},[s._v("1")])])])]),e("span",{staticClass:"vlist-s"},[s._v("​")])]),e("span",{staticClass:"vlist-r"},[e("span",{staticClass:"vlist",staticStyle:{height:"0.15em"}},[e("span")])])])])]),e("span",{staticClass:"mord"},[s._v("∣")]),e("span",{staticClass:"mord mathdefault",staticStyle:{"margin-right":"0.05764em"}},[s._v("S")]),e("span",{staticClass:"mopen"},[s._v("(")]),e("span",{staticClass:"mord mathdefault"},[s._v("n")]),e("span",{staticClass:"mclose"},[s._v(")")]),e("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}}),e("span",{staticClass:"mrel"},[s._v("=")]),e("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}})]),e("span",{staticClass:"base"},[e("span",{staticClass:"strut",staticStyle:{height:"1em","vertical-align":"-0.25em"}}),e("span",{staticClass:"mop"},[s._v("max")]),e("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.16666666666666666em"}}),e("span",{staticClass:"mord"},[e("span",{staticClass:"mopen"},[s._v("(")]),e("span",{staticClass:"mopen"},[s._v("{")]),e("span",{staticClass:"mord mathdefault",staticStyle:{"margin-right":"0.05764em"}},[s._v("S")]),e("span",{staticClass:"mopen"},[s._v("(")]),e("span",{staticClass:"mord mathdefault"},[s._v("n")]),e("span",{staticClass:"mclose"},[s._v(")")]),e("span",{staticClass:"mord"},[s._v("∣")]),e("span",{staticClass:"mord mathdefault"},[s._v("n")]),e("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}}),e("span",{staticClass:"mrel"},[s._v("∈")]),e("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}}),e("span",{staticClass:"mord"},[e("span",{staticClass:"mord mathdefault",staticStyle:{"margin-right":"0.10903em"}},[s._v("N")]),e("span",{staticClass:"msupsub"},[e("span",{staticClass:"vlist-t vlist-t2"},[e("span",{staticClass:"vlist-r"},[e("span",{staticClass:"vlist",staticStyle:{height:"0.30110799999999993em"}},[e("span",{staticStyle:{top:"-2.5500000000000003em","margin-left":"-0.10903em","margin-right":"0.05em"}},[e("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),e("span",{staticClass:"sizing reset-size6 size3 mtight"},[e("span",{staticClass:"mord mtight"},[s._v("1")])])])]),e("span",{staticClass:"vlist-s"},[s._v("​")])]),e("span",{staticClass:"vlist-r"},[e("span",{staticClass:"vlist",staticStyle:{height:"0.15em"}},[e("span")])])])])]),e("span",{staticClass:"mclose"},[s._v("}")]),e("span",{staticClass:"mclose"},[s._v(")")])]),e("span",{staticClass:"mclose"},[s._v("}")])])])]),s._v("。")]),s._v(" "),e("p",[s._v("优选策略的种类：")]),s._v(" "),e("ul",[e("li",[s._v("node_label：根据节点标签得分，存在标签既得分，没有标签没得分。标签越多 得分越高。")]),s._v(" "),e("li",[s._v("least_requested：选择消耗最小的节点（根据空闲比率评估 cpu(总容量-sum(已使用)*10/总容量) ）")]),s._v(" "),e("li",[s._v("balanced_resource_allocation：从节点列表中选出各项资源使用率最均衡的节点（CPU和内存）")]),s._v(" "),e("li",[s._v("node_prefer_avoid_pods：节点倾向")]),s._v(" "),e("li",[s._v("taint_toleration：将pod对象的"),e("code",[s._v("spec.toleration")]),s._v("与节点的"),e("code",[s._v("taints")]),s._v("列表项进行匹配度检查，匹配的条目越多，得分越低（后文介绍）。")]),s._v(" "),e("li",[s._v("selector_spreading：与services上其他pod尽量不在同一个节点上，节点上通一个service的pod越少得分越高。")]),s._v(" "),e("li",[s._v("interpod_affinity：遍历node上的亲和性条目，匹配项越多的得分越高")]),s._v(" "),e("li",[s._v("most_requested：选择消耗最大的节点上（尽量将一个节点上的资源用完）")]),s._v(" "),e("li",[s._v("image_locality：节点上有所需要的镜像既得分，所需镜像越多得分越高。（根据已有镜像体积大小之和）")])]),s._v(" "),e("h4",{attrs:{id:"优选策略的写法"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#优选策略的写法"}},[s._v("#")]),s._v(" 优选策略的写法")]),s._v(" "),e("p",[s._v("如上所述，优选策略是带权重的逻辑表达式，每个表达式在定义中都由权重"),e("code",[s._v("weight")]),s._v("和逻辑表达式"),e("code",[s._v("preference")]),s._v("两部分构成，例如：")]),s._v(" "),e("div",{staticClass:"language-yml line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-yml"}},[e("code",[e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("apiVersion")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" apps/v1\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("kind")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" Deployment\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("metadata")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("...")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("spec")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("...")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("template")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#Pod模板")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("metadata")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("...")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("spec")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("affinity")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("nodeAffinity")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#Node亲和性")]),s._v("\n          "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("preferredDuringSchedulingIgnoredDuringExecution")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#软策略")]),s._v("\n            "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("weight")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v("\n              "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("perference")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n                "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("...")]),s._v("\n            "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("weight")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v("\n              "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("perference")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n                "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("...")]),s._v("\n            "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("...")]),s._v("\n        "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("podAffinity")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#Pod亲和性")]),s._v("\n          "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("preferredDuringSchedulingIgnoredDuringExecution")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#软策略")]),s._v("\n            "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("weight")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("33")]),s._v("\n              "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("perference")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n                "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("...")]),s._v("\n            "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("weight")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("44")]),s._v("\n              "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("perference")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n                "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("...")]),s._v("\n            "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("...")]),s._v("\n        "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("podAntiAffinity")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#Pod反亲和性")]),s._v("\n          "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("preferredDuringSchedulingIgnoredDuringExecution")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#软策略")]),s._v("\n            "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("weight")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("55")]),s._v("\n              "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("perference")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n                "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("...")]),s._v("\n            "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("weight")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("66")]),s._v("\n              "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("perference")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n                "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("...")]),s._v("\n            "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("...")]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("containers")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("...")]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("...")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br"),e("span",{staticClass:"line-number"},[s._v("26")]),e("br"),e("span",{staticClass:"line-number"},[s._v("27")]),e("br"),e("span",{staticClass:"line-number"},[s._v("28")]),e("br"),e("span",{staticClass:"line-number"},[s._v("29")]),e("br"),e("span",{staticClass:"line-number"},[s._v("30")]),e("br"),e("span",{staticClass:"line-number"},[s._v("31")]),e("br"),e("span",{staticClass:"line-number"},[s._v("32")]),e("br"),e("span",{staticClass:"line-number"},[s._v("33")]),e("br"),e("span",{staticClass:"line-number"},[s._v("34")]),e("br"),e("span",{staticClass:"line-number"},[s._v("35")]),e("br"),e("span",{staticClass:"line-number"},[s._v("36")]),e("br"),e("span",{staticClass:"line-number"},[s._v("37")]),e("br"),e("span",{staticClass:"line-number"},[s._v("38")]),e("br"),e("span",{staticClass:"line-number"},[s._v("39")]),e("br"),e("span",{staticClass:"line-number"},[s._v("40")]),e("br"),e("span",{staticClass:"line-number"},[s._v("41")]),e("br")])]),e("h2",{attrs:{id:"亲和性调度匹配规则"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#亲和性调度匹配规则"}},[s._v("#")]),s._v(" 亲和性调度匹配规则")]),s._v(" "),e("h3",{attrs:{id:"node亲和性nodeaffinity"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#node亲和性nodeaffinity"}},[s._v("#")]),s._v(" Node亲和性"),e("code",[s._v("nodeAffinity")])]),s._v(" "),e("p",[s._v("Node亲和性用于指定Pod应该部署在满足某条件的节点上。")]),s._v(" "),e("h4",{attrs:{id:"常用的nodeaffinity：nodeselectorterms和matchexpressions-根据label选node"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#常用的nodeaffinity：nodeselectorterms和matchexpressions-根据label选node"}},[s._v("#")]),s._v(" 常用的"),e("code",[s._v("nodeAffinity")]),s._v("："),e("code",[s._v("nodeSelectorTerms")]),s._v("和"),e("code",[s._v("matchExpressions")]),s._v(" - 根据Label选Node")]),s._v(" "),e("blockquote",[e("p",[s._v("如果你同时指定了"),e("code",[s._v("nodeSelector")]),s._v("和"),e("code",[s._v("nodeAffinity")]),s._v("，两者必须都要满足，才能将Pod调度到候选节点上。")]),s._v(" "),e("p",[s._v("如果你指定了多个与"),e("code",[s._v("nodeAffinity")]),s._v("类型关联的"),e("code",[s._v("nodeSelectorTerms")]),s._v("，则如果其中一个"),e("code",[s._v("nodeSelectorTerms")]),s._v("满足的话，Pod将可以调度到节点上。")]),s._v(" "),e("p",[s._v("如果你指定了多个与"),e("code",[s._v("nodeSelectorTerms")]),s._v("关联的"),e("code",[s._v("matchExpressions")]),s._v("，则只有当所有"),e("code",[s._v("matchExpressions")]),s._v("满足的话，Pod才会可以调度到节点上。")])]),s._v(" "),e("p",[e("code",[s._v("nodeSelectorTerms")]),s._v("由一系列"),e("code",[s._v("matchExpressions")]),s._v("组成，每个"),e("code",[s._v("matchExpressions")]),s._v("由要匹配的Label名"),e("code",[s._v("key")]),s._v("、匹配操作"),e("code",[s._v("operator")]),s._v("和要匹配的值"),e("code",[s._v("values")]),s._v("三个部分组成。例如：")]),s._v(" "),e("div",{staticClass:"language-yml line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-yml"}},[e("code",[e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("apiVersion")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" apps/v1\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("kind")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" Deployment\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("metadata")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("...")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("spec")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("...")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("template")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#Pod模板")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("metadata")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("...")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("spec")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("affinity")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("nodeAffinity")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#Node亲和性")]),s._v("\n          "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("requiredDuringSchedulingIgnoredDuringExecution")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#运行过程中不生效的硬策略")]),s._v("\n            "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("nodeSelectorTerms")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n              "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("matchExpressions")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n                "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("key")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" kubernetes.io/hostname\n                  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("operator")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" NotIn\n                  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("values")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n                    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" node01\n                    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" node02\n                    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" node03\n                "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("key")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" disktype\n                  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("operator")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" In\n                  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("values")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n                    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" ssd\n          "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("preferredDuringSchedulingIgnoredDuringExecution")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n            "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("weight")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v("\n              "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("preference")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n                "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("matchExpressions")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n                  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("key")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" beta.kubernetes.io/arch\n                    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("operator")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" In\n                    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("values")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n                      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" amd64\n            "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("weight")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v("\n              "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("preference")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n                "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("matchExpressions")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n                  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("key")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" netspeed\n                    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("operator")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" Gt\n                    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("values")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n                      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000")]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("containers")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("...")]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("...")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br"),e("span",{staticClass:"line-number"},[s._v("26")]),e("br"),e("span",{staticClass:"line-number"},[s._v("27")]),e("br"),e("span",{staticClass:"line-number"},[s._v("28")]),e("br"),e("span",{staticClass:"line-number"},[s._v("29")]),e("br"),e("span",{staticClass:"line-number"},[s._v("30")]),e("br"),e("span",{staticClass:"line-number"},[s._v("31")]),e("br"),e("span",{staticClass:"line-number"},[s._v("32")]),e("br"),e("span",{staticClass:"line-number"},[s._v("33")]),e("br"),e("span",{staticClass:"line-number"},[s._v("34")]),e("br"),e("span",{staticClass:"line-number"},[s._v("35")]),e("br"),e("span",{staticClass:"line-number"},[s._v("36")]),e("br"),e("span",{staticClass:"line-number"},[s._v("37")]),e("br"),e("span",{staticClass:"line-number"},[s._v("38")]),e("br"),e("span",{staticClass:"line-number"},[s._v("39")]),e("br"),e("span",{staticClass:"line-number"},[s._v("40")]),e("br"),e("span",{staticClass:"line-number"},[s._v("41")]),e("br"),e("span",{staticClass:"line-number"},[s._v("42")]),e("br"),e("span",{staticClass:"line-number"},[s._v("43")]),e("br")])]),e("p",[s._v("表示匹配条件为：")]),s._v(" "),e("ul",[e("li",[s._v("硬策略：“"),e("code",[s._v("kubernetes.io/hostname")]),s._v("标签值不是"),e("code",[s._v("node01")]),s._v("、"),e("code",[s._v("node02")]),s._v("或"),e("code",[s._v("node03")]),s._v("”且“"),e("code",[s._v("disktype")]),s._v("标签值为"),e("code",[s._v("ssd")])]),s._v(" "),e("li",[s._v("软策略：\n"),e("ul",[e("li",[s._v("“"),e("code",[s._v("beta.kubernetes.io/arch")]),s._v("的值为"),e("code",[s._v("amd64")]),s._v("”值11分")]),s._v(" "),e("li",[s._v("“"),e("code",[s._v("netspeed")]),s._v("的值大于"),e("code",[s._v("1000")]),s._v("”值22分")])])])]),s._v(" "),e("p",[s._v("现在Kubernetes提供的操作符有下面的几种：")]),s._v(" "),e("ul",[e("li",[e("code",[s._v("In")]),s._v("：label 的值在某个列表中")]),s._v(" "),e("li",[e("code",[s._v("NotIn")]),s._v("：label 的值不在某个列表中")]),s._v(" "),e("li",[e("code",[s._v("Gt")]),s._v("：label 的值大于某个值")]),s._v(" "),e("li",[e("code",[s._v("Lt")]),s._v("：label 的值小于某个值")]),s._v(" "),e("li",[e("code",[s._v("Exists")]),s._v("：某个 label 存在")]),s._v(" "),e("li",[e("code",[s._v("DoesNotExist")]),s._v("：某个 label 不存在")])]),s._v(" "),e("h3",{attrs:{id:"pod亲和性podaffinity和pod反亲和性podantiaffinity"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#pod亲和性podaffinity和pod反亲和性podantiaffinity"}},[s._v("#")]),s._v(" Pod亲和性"),e("code",[s._v("podAffinity")]),s._v("和Pod反亲和性"),e("code",[s._v("podAntiAffinity")])]),s._v(" "),e("blockquote",[e("p",[s._v("Pod间亲和与反亲和使你可以"),e("em",[s._v("基于已经在节点上运行的Pod的标签")]),s._v("来约束Pod可以调度到的节点，而不是基于节点上的标签。规则的格式为“"),e("strong",[s._v("如果 X 节点上已经运行了一个或多个 满足规则 Y 的pod，则这个 pod 应该（或者在非亲和的情况下不应该）运行在 X 节点")]),s._v("”。Y 表示一个具有可选的关联命令空间列表的 LabelSelector。")])]),s._v(" "),e("blockquote",[e("p",[s._v("Pod 间亲和与反亲和需要大量的处理，这可能会显著减慢大规模集群中的调度。我们不建议在超过数百个节点的集群中使用它们。")])]),s._v(" "),e("p",[e("code",[s._v("podAffinity")]),s._v("和"),e("code",[s._v("podAntiAffinity")]),s._v("定义格式完全相同，但互为反义词：")]),s._v(" "),e("ul",[e("li",[e("code",[s._v("podAffinity")]),s._v("表示这个Pod应该和某个Pod部署在一起")]),s._v(" "),e("li",[e("code",[s._v("podAntiAffinity")]),s._v("表示这个Pod不应该和某个Pod部署在一起")]),s._v(" "),e("li",[e("code",[s._v("podAffinity")]),s._v("软策略将表示这个Pod应该和得分最高的Pod部署在一起")]),s._v(" "),e("li",[e("code",[s._v("podAntiAffinity")]),s._v("软策略将表示这个Pod不应该和得分最高的Pod部署在一起")])]),s._v(" "),e("h4",{attrs:{id:"重要知识：pod标签的namespace"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#重要知识：pod标签的namespace"}},[s._v("#")]),s._v(" 重要知识："),e("RouterLink",{attrs:{to:"/Kubernetes/Kubernetes对象/Namespace.html"}},[s._v("Pod标签的namespace")])],1),s._v(" "),e("h4",{attrs:{id:"重要知识：topologykey"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#重要知识：topologykey"}},[s._v("#")]),s._v(" 重要知识："),e("code",[s._v("topologyKey")])]),s._v(" "),e("p",[s._v('pod亲和性调度需要各个相关的pod对象运行于"同一位置"， 而反亲和性调度则要求他们不能运行于“同一位置”。这里指定 '),e("strong",[s._v("“同一位置” 是通过 "),e("code",[s._v("topologyKey")]),s._v(" 来定义的")]),s._v("："),e("code",[s._v("topologyKey")]),s._v(" 对应的值是 node 上的一个标签键，对应标签值相同的所有节点都被视为“同一位置”。")]),s._v(" "),e("p",[s._v("比如某些节点上有"),e("code",[s._v("zone=A")]),s._v("标签，还有一些节点有"),e("code",[s._v("zone=B")]),s._v("标签，pod affinity "),e("code",[s._v("topologyKey")]),s._v("定义为"),e("code",[s._v("zone")]),s._v("，那么调度pod的时候，所有"),e("code",[s._v("zone=A")]),s._v("的node就被视为为“同一位置”，"),e("code",[s._v("zone=B")]),s._v("的node也被视为“同一位置”，而"),e("code",[s._v("zone=A")]),s._v("的node和"),e("code",[s._v("zone=B")]),s._v("的node被视为处在不同的位置。")]),s._v(" "),e("p",[s._v("K8S节点自带标签"),e("code",[s._v("kubernetes.io/hostname")]),s._v("是最常用的"),e("code",[s._v("topologyKey")]),s._v("，它使得Pod不会调度到同一个node上。")]),s._v(" "),e("h4",{attrs:{id:"常用的podaffinity和podantiaffinity：labelselector"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#常用的podaffinity和podantiaffinity：labelselector"}},[s._v("#")]),s._v(" 常用的"),e("code",[s._v("podAffinity")]),s._v("和"),e("code",[s._v("podAntiAffinity")]),s._v("："),e("code",[s._v("labelSelector")])]),s._v(" "),e("p",[e("code",[s._v("podAffinity")]),s._v("和"),e("code",[s._v("podAntiAffinity")]),s._v("中"),e("code",[s._v("labelSelector")]),s._v("的语法与"),e("code",[s._v("nodeAffinity")]),s._v("中的"),e("code",[s._v("nodeSelectorTerms")]),s._v("大致相同，不同的是：")]),s._v(" "),e("table",[e("thead",[e("tr",[e("th",[e("code",[s._v("podAffinity")]),s._v("/"),e("code",[s._v("podAntiAffinity")])]),s._v(" "),e("th",[e("code",[s._v("nodeAffinity")])])])]),s._v(" "),e("tbody",[e("tr",[e("td",[s._v("一个"),e("code",[s._v("podAffinity")]),s._v("可以有多个"),e("code",[s._v("labelSelector")])]),s._v(" "),e("td",[s._v("一个"),e("code",[s._v("nodeAffinity")]),s._v("只能有一个"),e("code",[s._v("nodeSelectorTerms")])])]),s._v(" "),e("tr",[e("td",[s._v("一个"),e("code",[s._v("labelSelector")]),s._v("只能有一个"),e("code",[s._v("matchExpressions")])]),s._v(" "),e("td",[s._v("一个"),e("code",[s._v("nodeSelectorTerms")]),s._v("可以有多个"),e("code",[s._v("matchExpressions")])])]),s._v(" "),e("tr",[e("td",[e("code",[s._v("matchExpressions")]),s._v("支持"),e("code",[s._v("In")]),s._v("、"),e("code",[s._v("NotIn")]),s._v("、"),e("code",[s._v("Exists")]),s._v("、"),e("code",[s._v("DoesNotExist")])]),s._v(" "),e("td",[e("code",[s._v("matchExpressions")]),s._v("支持"),e("code",[s._v("In")]),s._v("、"),e("code",[s._v("NotIn")]),s._v("、"),e("code",[s._v("Gt")]),s._v("、"),e("code",[s._v("Lt")]),s._v("、"),e("code",[s._v("Exists")]),s._v("、"),e("code",[s._v("DoesNotExist")])])])])]),s._v(" "),e("h4",{attrs:{id:"典型案例"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#典型案例"}},[s._v("#")]),s._v(" 典型案例")]),s._v(" "),e("blockquote",[e("p",[s._v("在三节点集群中，一个 web 应用程序具有内存缓存，例如 redis。我们希望 web 服务器尽可能与缓存放置在同一位置。")])]),s._v(" "),e("p",[s._v("例如有三个Redis缓存，我们希望它们两两之间不要部署在一起，那就给打个标签并且在"),e("code",[s._v("podAntiAffinity")]),s._v("里面写上这个标签：")]),s._v(" "),e("div",{staticClass:"language-yml line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-yml"}},[e("code",[e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("apiVersion")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" apps/v1\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("kind")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" Deployment\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("metadata")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" redis"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("cache\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("spec")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("selector")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("matchLabels")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("app")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" store\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("replicas")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("template")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("metadata")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("labels")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("app")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" store\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("spec")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("affinity")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("podAntiAffinity")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n          "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("requiredDuringSchedulingIgnoredDuringExecution")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n          "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("labelSelector")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n              "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("matchExpressions")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n              "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("key")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" app\n                "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("operator")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" In\n                "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("values")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n                "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" store\n            "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("topologyKey")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"kubernetes.io/hostname"')]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("containers")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" redis"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("server\n        "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" redis"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("3.2"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("alpine\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br"),e("span",{staticClass:"line-number"},[s._v("26")]),e("br"),e("span",{staticClass:"line-number"},[s._v("27")]),e("br")])]),e("p",[s._v("然后web服务中就将这个"),e("code",[s._v("store")]),s._v("标签放在"),e("code",[s._v("podAffinity")]),s._v("里面从而使得web服务和Redis缓存部署在一起；并且同理用"),e("code",[s._v("podAntiAffinity")]),s._v("使得web服务不会两两部署在一起：")]),s._v(" "),e("div",{staticClass:"language-yml line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-yml"}},[e("code",[e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("apiVersion")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" apps/v1\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("kind")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" Deployment\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("metadata")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" web"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("server\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("spec")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("selector")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("matchLabels")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("app")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" web"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("store\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("replicas")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("template")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("metadata")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("labels")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("app")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" web"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("store\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("spec")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("affinity")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("podAntiAffinity")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n          "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("requiredDuringSchedulingIgnoredDuringExecution")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n          "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("labelSelector")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n              "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("matchExpressions")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n              "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("key")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" app\n                "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("operator")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" In\n                "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("values")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n                "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" web"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("store\n            "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("topologyKey")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"kubernetes.io/hostname"')]),s._v("\n        "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("podAffinity")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n          "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("requiredDuringSchedulingIgnoredDuringExecution")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n          "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("labelSelector")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n              "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("matchExpressions")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n              "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("key")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" app\n                "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("operator")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" In\n                "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("values")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n                "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" store\n            "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("topologyKey")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"kubernetes.io/hostname"')]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("containers")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" web"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("app\n        "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" nginx"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("1.16"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("alpine\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br"),e("span",{staticClass:"line-number"},[s._v("26")]),e("br"),e("span",{staticClass:"line-number"},[s._v("27")]),e("br"),e("span",{staticClass:"line-number"},[s._v("28")]),e("br"),e("span",{staticClass:"line-number"},[s._v("29")]),e("br"),e("span",{staticClass:"line-number"},[s._v("30")]),e("br"),e("span",{staticClass:"line-number"},[s._v("31")]),e("br"),e("span",{staticClass:"line-number"},[s._v("32")]),e("br"),e("span",{staticClass:"line-number"},[s._v("33")]),e("br"),e("span",{staticClass:"line-number"},[s._v("34")]),e("br"),e("span",{staticClass:"line-number"},[s._v("35")]),e("br"),e("span",{staticClass:"line-number"},[s._v("36")]),e("br")])])])}),[],!1,null,null,null);t.default=n.exports}}]);